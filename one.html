<!DOCTYPE html>
<html>
<head>
	<title>Real-time Comment Box</title>
	<script>// Load existing comments on page load
window.onload = function() {
  loadComments();
}

// Load comments from XML file
function loadComments() {
  var xmlhttp = new XMLHttpRequest();
  xmlhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      var xmlDoc = this.responseXML;
      var comments = xmlDoc.getElementsByTagName('comment');
      var commentContainer = document.getElementById('comment-container');
      for (var i = 0; i < comments.length; i++) {
        var commentDiv = document.createElement('div');
        commentDiv.className = 'comment-box';
        var nameElem = comments[i].getElementsByTagName('name')[0];
        var name = nameElem.childNodes[0].nodeValue;
        var commentElem = comments[i].getElementsByTagName('text')[0];
        var commentText = commentElem.childNodes[0].nodeValue;
        var namePara = document.createElement('h5');
        var nameNode = document.createTextNode(name);
        namePara.appendChild(nameNode);
        var commentPara = document.createElement('p');
        var commentNode = document.createTextNode(commentText);
        commentPara.appendChild(commentNode);
        commentDiv.appendChild(namePara);
        commentDiv.appendChild(commentPara);
        commentContainer.appendChild(commentDiv);
      }
    }
  };
  xmlhttp.open('GET', 'comments.xml', true);
  xmlhttp.send();
}

// Save comment to XML file
function saveComment(name, comment) {
  var xmlhttp = new XMLHttpRequest();
  xmlhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      var xmlDoc = this.responseXML;
      var newComment = xmlDoc.createElement('comment');
      var newName = xmlDoc.createElement('name');
      var nameText = xmlDoc.createTextNode(name);
      newName.appendChild(nameText);
      var newText = xmlDoc.createElement('text');
      var commentText = xmlDoc.createTextNode(comment);
      newText.appendChild(commentText);
      newComment.appendChild(newName);
      newComment.appendChild(newText);
      xmlDoc.getElementsByTagName('comments')[0].appendChild(newComment);
      var xmlString = new XMLSerializer().serializeToString(xmlDoc);
      localStorage.setItem('comments', xmlString);
      renderComment(name, comment);
    }
  };
  xmlhttp.open('GET', 'comments.xml', true);
  xmlhttp.send();
}

// Render new comment
function renderComment(name, comment) {
  var commentDiv = document.createElement('div');
  commentDiv.className = 'comment-box';
  var namePara = document.createElement('h5');
  var nameNode = document.createTextNode(name);
  namePara.appendChild(nameNode);
  var commentPara = document.createElement('p');
  var commentNode = document.createTextNode(comment);
  commentPara.appendChild(commentNode);
  commentDiv.appendChild(namePara);
  commentDiv.appendChild(commentPara);
  document.getElementById('comment-container').appendChild(commentDiv);
  document.getElementById('comment-input').value = ''; // clear the comment input field
}

// Handle submit button click event
document.getElementById('submit-btn').addEventListener('click', function(event) {
event.preventDefault(); // prevent form submission
var name = document.getElementById('name-input').value;
var comment = document.getElementById('comment-input').value;
saveComment(name, comment);
});

// Check if comments are stored in local storage and load them if available
if (localStorage.getItem('comments')) {
var xmlString = localStorage.getItem('comments');
var parser = new DOMParser();
var xmlDoc = parser.parseFromString(xmlString, 'text/xml');
var comments = xmlDoc.getElementsByTagName('comment');
var commentContainer = document.getElementById('comment-container');
for (var i = 0; i < comments.length; i++) {
var nameElem = comments[i].getElementsByTagName('name')[0];
var name = nameElem.childNodes[0].nodeValue;
var commentElem = comments[i].getElementsByTagName('text')[0];
var commentText = commentElem.childNodes[0].nodeValue;
renderComment(name, commentText);
}
}</script>
</head>
<body>
	<h1>Real-time Comment Box</h1>
	<div id="comment-container"></div>
	<form>
		<label>Name:</label>
		<input type="text" id="name" required><br>
		<label>Comment:</label>
		<textarea id="comment" required></textarea><br>
		<input type="button" value="Submit" onclick="submitComment()">
	</form>
</body>
</html>
